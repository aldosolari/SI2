---
title: "Golub data"
output:
  pdf_document: default
  html_document: default
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE, eval=T, message=F, warning=F, error=F, 
                      comment=NA)
```

Gene expression data (3051 genes and 38 tumor mRNA samples) from the leukemia microarray study of Golub et al. (1999). 

Load Golub data from the R package multtest:

```{r}
rm(list=ls())
require(multtest)
data(golub)
Y <- t(golub)
colnames(Y) <- golub.gnames[,3]
X <- golub.cl
m <- ncol(Y)
n <- nrow(Y)
```

Perform $m=3051$ two-sample Student t tests and compute the $p$-values:

```{r}
pval = sapply(1:m, function(i) t.test(Y[X==0,i],Y[X==1,i], var.equal = T)$p.value)
hist(pval,20)
```

Number of rejections by using uncorrected tests, Bonferroni, Holm and Hochberg at level $\alpha=0.05$: 
```{r}
alpha = 0.05
sum(pval <= alpha)
sum(p.adjust(pval, "bonf") <= alpha)
sum(p.adjust(pval, "holm") <= alpha)
sum(p.adjust(pval, "hochberg") <= alpha)
```

Number of rejections by Benjamini-Hochberg and Benjamini-Yekutieli at level $\alpha=0.05$:

```{r}
sum(p.adjust(pval, "BH") <= alpha)
sum(p.adjust(pval, "BY") <= alpha)
```

Number of rejections by adaptive BKY procedure:

```{r}
alphastar = alpha/(1-alpha)
hatpi0 = (m - sum(p.adjust(pval, "BH") <= alphastar))/m
sum(p.adjust(pval, "BH") <= alphastar/hatpi0)
```

Number of rejections by adaptive Storey procedure:
```{r}
lambda = 1/2
hatpi0 = (sum(pval > lambda)+1)/((1-lambda)*m)
sum(p.adjust(pval, "BH") <= alpha/hatpi0)
```
